/**
 * HeroEnhanced.jsx.example - Enhanced Hero component with API integration
 *
 * This is an ENHANCED version of Hero.jsx that demonstrates:
 * - Checking authentication status
 * - Dynamic button behavior based on user state
 * - API-driven content
 *
 * To activate:
 * 1. Rename to Hero.jsx (replace the existing one)
 * 2. Refresh browser
 *
 * Or keep as reference and copy features you want
 */

const HeroEnhanced = () => {
  const [isAuthenticated, setIsAuthenticated] = React.useState(false);
  const [userName, setUserName] = React.useState('');
  const [loading, setLoading] = React.useState(true);

  // Check authentication on component mount
  React.useEffect(() => {
    async function checkAuth() {
      try {
        const isAuth = await window.ReactAPI.isAuthenticated();
        setIsAuthenticated(isAuth);

        if (isAuth) {
          const user = await window.ReactAPI.getCurrentUser();
          setUserName(user.first_name || user.username);
        }
      } catch (err) {
        console.log('Auth check skipped:', err.message);
      } finally {
        setLoading(false);
      }
    }

    checkAuth();
  }, []);

  const handleSignUp = async (e) => {
    e.preventDefault();

    if (isAuthenticated) {
      // Already logged in, go to dashboard
      if (window.LunaraNavigate) {
        window.LunaraNavigate('dashboard.html');
      } else {
        window.location.href = 'dashboard.html';
      }
    } else {
      // Not logged in, go to signup
      if (window.LunaraNavigate) {
        window.LunaraNavigate('signup.html');
      } else {
        window.location.href = 'signup.html';
      }
    }
  };

  const handleHowItWorks = (e) => {
    e.preventDefault();
    // Smooth scroll to how-it-works section
    const section = document.getElementById('how-it-works');
    if (section) {
      section.scrollIntoView({ behavior: 'smooth' });
    }
  };

  return (
    <section id="home" className="hero">
      <div className="container">
        <div className="hero-content">
          <h1 className="hero-title">
            {isAuthenticated && userName
              ? `Welcome back, ${userName}! ğŸ‘‹`
              : 'Your Projects. Fully Protected.'}
          </h1>
          <p className="hero-subtitle">
            {isAuthenticated
              ? 'Ready to manage your projects with total security and transparency.'
              : 'Lunara ensures your work, payments, and collaborations are handled with total trust and transparency. No surprises. Just results.'}
          </p>
          <div className="cta-buttons">
            <a
              href="#"
              className="btn btn-primary"
              onClick={handleSignUp}
            >
              {loading ? 'â³' : isAuthenticated ? 'ğŸ“Š Go to Dashboard' : 'ğŸš€ Let\'s Go!'}
            </a>
            <a
              href="#"
              className="btn btn-secondary"
              onClick={handleHowItWorks}
            >
              ğŸ‘€ Show Me How
            </a>
          </div>
        </div>
      </div>
    </section>
  );
};

// Export for use in react-app.js
window.Hero = HeroEnhanced;

/*
  BENEFITS OF THIS ENHANCED VERSION:

  âœ… Dynamic greeting for logged-in users
  âœ… Button changes based on auth status
  âœ… Uses ReactAPI for authentication check
  âœ… Preserves all existing styling
  âœ… Falls back to non-API behavior if API fails

  TO ACTIVATE:
  1. Backup current Hero.jsx:
     cp react-components/Hero.jsx react-components/Hero.jsx.backup

  2. Replace with this version:
     mv react-components/HeroEnhanced.jsx.example react-components/Hero.jsx

  3. Refresh browser - should see personalized greeting if logged in!
*/