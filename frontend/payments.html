<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lunara - Payments</title>
<!-- Favicon and Icons -->
<link rel="icon" type="image/x-icon" href="favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<meta name="theme-color" content="#6366f1">

<!-- Essential Meta Tags for Security -->
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' https://images.unsplash.com data:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; connect-src 'self' https://images.unsplash.com;">
<meta name="robots" content="noindex, nofollow">

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<!-- Core Stylesheets -->
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/dashboard.css">
<link rel="stylesheet" href="css/dashboard-authentic.css">
</head>
<body>

<!-- PLACEHOLDER: User authentication should be verified server-side before rendering this page -->

<header id="header">
  <div class="container">
    <div class="logo" data-action="dashboard" style="cursor: pointer;">Lunara</div>
    <nav class="nav" aria-label="Main navigation">
      <a href="#" data-action="dashboard" class="nav-link">Dashboard</a>
      <a href="#" data-action="projects" class="nav-link">Projects <span class="nav-badge">7</span></a>
      <a href="#" data-action="payments" class="nav-link active">Payments <span class="nav-badge urgent">2</span></a>
      <a href="#" data-action="messages" class="nav-link">Messages <span class="nav-badge">12</span></a>
    </nav>
    <div class="header-buttons">
      <button class="btn-icon notification-btn urgent-pulse" title="Urgent notifications" data-action="notifications" aria-label="5 urgent notifications">
        ğŸš¨
        <span class="notification-badge urgent">5</span>
      </button>
      <a href="#" data-action="profile" class="profile-mini" aria-label="View profile">
        <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face" alt="Jordan Chen - Freelance Developer" loading="lazy" crossorigin="anonymous">
        <span data-user-name>Jordan</span>
      </a>
      <a href="#" data-action="logout" class="btn btn-secondary">Logout</a>
    </div>
    <button id="mobile-menu" class="mobile-menu" aria-label="Toggle mobile menu" aria-expanded="false">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </div>
</header>

<!-- Critical Alert Banner for Payments -->
<div class="alert-banner critical">
  <div class="container">
    <div class="alert-content">
      <span class="alert-icon">ğŸ’¸</span>
      <span class="alert-text"><strong>Payment Alert:</strong> $3,200 in overdue payments require immediate attention</span>
      <button class="alert-action" onclick="focusOverdueSection()">Review Overdue</button>
      <button class="alert-dismiss" onclick="this.parentElement.parentElement.style.display='none'">&times;</button>
    </div>
  </div>
</div>

<main class="dashboard-main">
  <section class="dashboard-hero">
    <div class="container">
      <div class="welcome-card">
        <div class="welcome-content">
          <h1>ğŸ’° Payments & Escrow - Coming Soon!</h1>
          <p>Your cousin is building the payment management system. Almost ready!</p>
          <span class="last-login">This page will handle: Escrow management, invoicing, payment tracking, and financial reporting</span>
        </div>
        <div class="quick-stats">
          <div class="stat-item urgent">
            <span class="stat-value" data-count="2">2</span>
            <span class="stat-label">Overdue</span>
          </div>
          <div class="stat-item warning">
            <span class="stat-value" data-amount="3200">$3,200</span>
            <span class="stat-label">Outstanding</span>
          </div>
          <div class="stat-item success">
            <span class="stat-value" data-percentage="87">87%</span>
            <span class="stat-label">Paid On Time</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="dashboard-content">
    <div class="container">
      <div class="dashboard-grid">
        <div class="main-content">
          <div class="widget">
            <h2>ğŸ—ï¸ Payment Features in Development</h2>
            <div class="feature-preview">
              <div class="preview-item urgent">
                <div class="preview-icon">âš ï¸</div>
                <div class="preview-content">
                  <h3>Overdue Payment Management</h3>
                  <p>Track and chase overdue payments with automated reminders and escalation workflows</p>
                  <small style="color: var(--error);">2 payments currently overdue - TechFlow ($2,400), StartupABC ($800)</small>
                </div>
              </div>
              <div class="preview-item">
                <div class="preview-icon">ğŸ¦</div>
                <div class="preview-content">
                  <h3>Escrow Management</h3>
                  <p>Secure escrow system with milestone-based releases and dispute resolution</p>
                </div>
              </div>
              <div class="preview-item">
                <div class="preview-icon">ğŸ§¾</div>
                <div class="preview-content">
                  <h3>Invoice Generation</h3>
                  <p>Professional invoicing with automated follow-ups and payment tracking</p>
                </div>
              </div>
              <div class="preview-item">
                <div class="preview-icon">ğŸ“Š</div>
                <div class="preview-content">
                  <h3>Financial Analytics</h3>
                  <p>Revenue analytics, payment patterns, and financial forecasting tools</p>
                </div>
              </div>
              <div class="preview-item">
                <div class="preview-icon">ğŸ”’</div>
                <div class="preview-content">
                  <h3>Secure Transactions</h3>
                  <p>Bank-level security with PCI compliance and encrypted payment processing</p>
                </div>
              </div>
              <div class="preview-item">
                <div class="preview-icon">ğŸ“±</div>
                <div class="preview-content">
                  <h3>Multi-Payment Methods</h3>
                  <p>Support for credit cards, bank transfers, PayPal, and cryptocurrency payments</p>
                </div>
              </div>
            </div>
          </div>

          <div class="widget" id="overdue-section">
            <div class="widget-header">
              <h2>ğŸš¨ Urgent: Overdue Payments</h2>
              <span class="urgency-indicator">2 critical items</span>
            </div>
            <div class="urgent-list">
              <div class="urgent-item critical">
                <div class="urgent-icon">ğŸ’¸</div>
                <div class="urgent-content">
                  <div class="urgent-title">TechFlow Ltd. - Analytics Dashboard</div>
                  <div class="urgent-subtitle">$2,400 â€¢ 3 days overdue â€¢ 2 reminders sent</div>
                </div>
                <button class="btn-urgent" onclick="chaseSpecificPayment('techflow')">Chase Now</button>
              </div>
              <div class="urgent-item warning">
                <div class="urgent-icon">â°</div>
                <div class="urgent-content">
                  <div class="urgent-title">StartupABC - Logo Design</div>
                  <div class="urgent-subtitle">$800 â€¢ 1 day overdue â€¢ 1 reminder sent</div>
                </div>
                <button class="btn-urgent" onclick="chaseSpecificPayment('startupabc')">Follow Up</button>
              </div>
            </div>
          </div>
        </div>

        <div class="sidebar">
          <div class="widget">
            <h3>ğŸ“ˆ Payment Statistics</h3>
            <div class="earnings-breakdown">
              <div class="breakdown-item">
                <span>This Month Received</span>
                <span class="amount positive">$4,200</span>
              </div>
              <div class="breakdown-item">
                <span>Pending in Escrow</span>
                <span class="amount warning">$5,600</span>
              </div>
              <div class="breakdown-item">
                <span>Overdue Payments</span>
                <span class="amount fee">$3,200</span>
              </div>
              <div class="breakdown-item">
                <span>Next Week Expected</span>
                <span class="amount positive">$2,800</span>
              </div>
            </div>
          </div>

          <div class="widget">
            <h3>âš¡ Quick Payment Actions</h3>
            <div class="survival-grid">
              <button class="survival-action critical" onclick="chaseAllOverdue()">
                <div class="survival-icon">ğŸ“§</div>
                <span>Chase All Overdue<br><small>2 clients</small></span>
              </button>
              <button class="survival-action normal" onclick="generateNewInvoice()">
                <div class="survival-icon">ğŸ§¾</div>
                <span>New Invoice<br><small>Quick create</small></span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div style="margin-top: 2rem; text-align: center;">
        <p style="color: var(--text-muted); margin-bottom: 1rem;">
          ğŸ’¡ <strong>For Developers:</strong> URL parameters supported:<br>
          <code>?tab=overdue</code> <code>?highlight=proj_123</code> <code>?tab=invoices</code>
        </p>
        <button data-action="dashboard" class="btn btn-primary">
          Back to Dashboard
        </button>
      </div>
    </div>
  </section>
</main>

<!-- Mobile Navigation Overlay -->
<div class="mobile-nav-overlay">
  <nav class="mobile-nav" aria-label="Mobile navigation">
    <a href="#" data-action="dashboard" class="mobile-nav-link">Dashboard</a>
    <a href="#" data-action="projects" class="mobile-nav-link">Projects <span class="nav-badge">7</span></a>
    <a href="#" data-action="payments" class="mobile-nav-link active">Payments <span class="nav-badge urgent">2</span></a>
    <a href="#" data-action="messages" class="mobile-nav-link">Messages <span class="nav-badge">12</span></a>
    <div class="mobile-nav-buttons">
      <a href="#" data-action="profile" class="btn btn-secondary">Profile</a>
      <a href="#" data-action="logout" class="btn btn-primary">Logout</a>
    </div>
  </nav>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // Mobile menu functionality
  const mobileMenu = document.getElementById('mobile-menu');
  const mobileOverlay = document.querySelector('.mobile-nav-overlay');

  mobileMenu?.addEventListener('click', () => {
    mobileOverlay.classList.toggle('active');
    const isExpanded = mobileMenu.getAttribute('aria-expanded') === 'true';
    mobileMenu.setAttribute('aria-expanded', !isExpanded);
  });

  mobileOverlay?.addEventListener('click', (e) => {
    if (e.target === mobileOverlay) {
      mobileOverlay.classList.remove('active');
      mobileMenu?.setAttribute('aria-expanded', 'false');
    }
  });

  // Show URL parameters if any
  const urlParams = new URLSearchParams(window.location.search);
  if (urlParams.toString()) {
    showToast(`Payment page loaded with: ${urlParams.toString()}`, 'info');
  }

  // Auto-focus overdue section if coming from dashboard
  if (urlParams.get('tab') === 'overdue') {
    focusOverdueSection();
  }
});

function focusOverdueSection() {
  const overdueSection = document.getElementById('overdue-section');
  if (overdueSection) {
    overdueSection.scrollIntoView({ behavior: 'smooth' });
    overdueSection.style.border = '2px solid var(--error)';
    setTimeout(() => {
      overdueSection.style.border = '';
    }, 3000);
  }
}

function chaseSpecificPayment(clientId) {
  const clientNames = {
    'techflow': 'TechFlow Ltd.',
    'startupabc': 'StartupABC'
  };

  const clientName = clientNames[clientId] || clientId;
  const confirmed = confirm(`Send payment reminder to ${clientName}?\n\nThis will:\nâ€¢ Send a firm but professional reminder\nâ€¢ Log the interaction\nâ€¢ Set follow-up reminder\n\nProceed?`);

  if (confirmed) {
    showToast(`Payment reminder sent to ${clientName} ğŸ“§`, 'warning');

    // Update UI to show action taken
    setTimeout(() => {
      showToast('âœ… Reminder sent successfully', 'success');
    }, 2000);
  }
}

function chaseAllOverdue() {
  const confirmed = confirm('Send payment reminders to all overdue clients?\n\nThis will send professional but firm reminders to:\nâ€¢ TechFlow Ltd. ($2,400)\nâ€¢ StartupABC ($800)\n\nTotal: $3,200 overdue\n\nProceed?');

  if (confirmed) {
    showToast('Sending payment reminders to all overdue clients...', 'warning');

    setTimeout(() => {
      showToast('âœ… All payment reminders sent successfully', 'success');
    }, 2500);
  }
}

function generateNewInvoice() {
  showToast('Opening invoice generator...', 'info');
  // This would open a modal or navigate to invoice creation
  setTimeout(() => {
    showToast('Invoice feature coming soon! ğŸ§¾', 'warning');
  }, 1000);
}

function showToast(message, type = 'info') {
  const existingToasts = document.querySelectorAll('.toast');
  const topOffset = 20 + (existingToasts.length * 60);

  const toast = document.createElement('div');
  toast.className = 'toast';
  toast.textContent = message;
  toast.style.cssText = `
    position: fixed; top: ${topOffset}px; right: 20px; z-index: 10000;
    background: ${type === 'error' ? '#ef4444' : type === 'success' ? '#10b981' : type === 'warning' ? '#f59e0b' : '#6366f1'};
    color: white; padding: 12px 20px; border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15); font-size: 14px;
    transform: translateX(100%); transition: all 0.3s ease; margin-bottom: 8px;
  `;

  document.body.appendChild(toast);

  setTimeout(() => toast.style.transform = 'translateX(0)', 100);
  setTimeout(() => {
    toast.style.transform = 'translateX(100%)';
    setTimeout(() => {
      if (document.body.contains(toast)) {
        document.body.removeChild(toast);
        // Reposition remaining toasts
        const remaining = document.querySelectorAll('.toast');
        remaining.forEach((t, i) => t.style.top = `${20 + (i * 60)}px`);
      }
    }, 300);
  }, 4000);
}
</script>

<script src="js/ui.js"></script>
<script src="js/button_logic.js"></script>

<script src="js/api.js"></script>
<script src="js/navigation.js"></script>
</body>
</html>