<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SafeSend - Messages</title>
<!-- Favicon and Icons -->
<link rel="icon" type="image/x-icon" href="favicon.ico">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<meta name="theme-color" content="#6366f1">

<!-- Essential Meta Tags for Security -->
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; img-src 'self' https://images.unsplash.com data:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; script-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com; connect-src 'self' https://images.unsplash.com;">
<meta name="robots" content="noindex, nofollow">

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<!-- Core Stylesheets -->
<link rel="stylesheet" href="css/style.css">
<link rel="stylesheet" href="css/dashboard.css">
<link rel="stylesheet" href="css/dashboard-authentic.css">
<link rel="stylesheet" href="css/mobile-nav.css">
</head>
<body>

<!-- PLACEHOLDER: User authentication should be verified server-side before rendering this page -->

<header id="header">
  <div class="container">
    <div class="logo" data-action="dashboard">SafeSend</div>
    <nav class="nav" aria-label="Main navigation">
      <a href="#" data-action="dashboard" class="nav-link">Dashboard</a>
      <a href="#" data-action="projects" class="nav-link">Projects <span class="nav-badge">7</span></a>
      <a href="#" data-action="payments" class="nav-link">Payments <span class="nav-badge urgent">2</span></a>
      <a href="#" data-action="messages" class="nav-link active">Messages <span class="nav-badge">12</span></a>
    </nav>
    <div class="header-buttons">
      <button class="btn-icon notification-btn urgent-pulse" title="Urgent notifications" data-action="notifications" aria-label="5 urgent notifications">
        ğŸš¨
        <span class="notification-badge urgent">5</span>
      </button>
      <a href="#" data-action="profile" class="profile-mini" aria-label="View profile">
        <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=40&h=40&fit=crop&crop=face" alt="Jordan Chen - Freelance Developer" loading="lazy" crossorigin="anonymous">
        <span data-user-name>Jordan</span>
      </a>
      <a href="#" data-action="logout" class="btn btn-secondary">Logout</a>
    </div>
    <button id="mobile-menu" class="mobile-menu" aria-label="Toggle mobile menu" aria-expanded="false">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </div>
</header>

<!-- Urgent Message Alert -->
<div class="alert-banner warning">
  <div class="container">
    <div class="alert-content">
      <span class="alert-icon">ğŸ’¬</span>
      <span class="alert-text"><strong>Urgent Messages:</strong> 3 clients need immediate responses</span>
      <button class="alert-action" onclick="showUrgentMessages()">Review Now</button>
      <button class="alert-dismiss" onclick="this.parentElement.parentElement.style.display='none'">&times;</button>
    </div>
  </div>
</div>

<main class="dashboard-main">
  <section class="dashboard-hero">
    <div class="container">
      <div class="welcome-card">
        <div class="welcome-content">
          <h1>ğŸ’¬ Messages & Communication - Coming Soon!</h1>
          <p>Your cousin is developing the messaging system. Client communication made easy!</p>
          <span class="last-login">This page will include: Real-time chat, file sharing, project discussions, and client collaboration</span>
        </div>
        <div class="quick-stats">
          <div class="stat-item urgent">
            <span class="stat-value" data-count="3">3</span>
            <span class="stat-label">Urgent</span>
          </div>
          <div class="stat-item warning">
            <span class="stat-value" data-count="7">7</span>
            <span class="stat-label">Unread</span>
          </div>
          <div class="stat-item success">
            <span class="stat-value" data-count="12">12</span>
            <span class="stat-label">Total Today</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="dashboard-content">
    <div class="container">
      <div class="dashboard-grid">
        <div class="main-content">
          <div class="widget" id="urgent-messages">
            <div class="widget-header">
              <h2>ğŸš¨ Urgent Messages</h2>
              <span class="urgency-indicator">3 need responses</span>
            </div>
            <div class="urgent-list">
              <div class="urgent-item critical">
                <div class="urgent-icon">ğŸ“±</div>
                <div class="urgent-content">
                  <div class="urgent-title">Dr. Martinez (HealthTech) called twice</div>
                  <div class="urgent-subtitle">About tonight's UI mockup deadline â€¢ Last message 34 min ago</div>
                </div>
                <button class="btn-urgent" onclick="replyToClient('healthtech')">Call Back</button>
              </div>
              <div class="urgent-item warning">
                <div class="urgent-icon">ğŸ’¸</div>
                <div class="urgent-content">
                  <div class="urgent-title">TechFlow payment discussion needed</div>
                  <div class="urgent-subtitle">$2,400 overdue â€¢ Scheduled call at 6:00 PM</div>
                </div>
                <button class="btn-urgent" onclick="replyToClient('techflow')">Prepare Response</button>
              </div>
              <div class="urgent-item info">
                <div class="urgent-icon">ğŸ”§</div>
                <div class="urgent-content">
                  <div class="urgent-title">Sarah (EcoTech) wants scope change</div>
                  <div class="urgent-subtitle">Additional API endpoints requested â€¢ Needs quote</div>
                </div>
                <button class="btn-urgent" onclick="replyToClient('ecotech')">Discuss Scope</button>
              </div>
            </div>
          </div>

          <div class="widget">
            <h2>ğŸ’» Message Features in Development</h2>
            <div class="feature-preview">
              <div class="preview-item">
                <div class="preview-icon">ğŸ’¬</div>
                <div class="preview-content">
                  <h3>Real-Time Chat</h3>
                  <p>Instant messaging with typing indicators, read receipts, and emoji reactions</p>
                </div>
              </div>
              <div class="preview-item">
                <div class="preview-icon">ğŸ“</div>
                <div class="preview-content">
                  <h3>File Sharing</h3>
                  <p>Secure file uploads, version control, and collaborative document editing</p>
                </div>
              </div>
              <div class="preview-item">
                <div class="preview-icon">ğŸ¯</div>
                <div class="preview-content">
                  <h3>Project Threads</h3>
                  <p>Organized conversations by project with milestone discussions and feedback loops</p>
                </div>
              </div>
              <div class="preview-item">
                <div class="preview-icon">ğŸ“</div>
                <div class="preview-content">
                  <h3>Video Calls</h3>
                  <p>Integrated video conferencing with screen sharing and session recording</p>
                </div>
              </div>
              <div class="preview-item">
                <div class="preview-icon">ğŸ””</div>
                <div class="preview-content">
                  <h3>Smart Notifications</h3>
                  <p>Priority-based alerts, quiet hours, and customizable notification preferences</p>
                </div>
              </div>
              <div class="preview-item">
                <div class="preview-icon">ğŸ“‹</div>
                <div class="preview-content">
                  <h3>Message Templates</h3>
                  <p>Pre-written responses for common situations like payment reminders and project updates</p>
                </div>
              </div>
            </div>
          </div>

          <div class="widget">
            <div class="widget-header">
              <h2>ğŸ“¬ Recent Conversations Preview</h2>
              <span class="chaos-count">Live demo</span>
            </div>
            <div class="message-list">
              <div class="message-item unread" onclick="openConversation('healthtech')">
                <img src="https://images.unsplash.com/photo-1612349317150-e413f6a5b16d?w=40&h=40&fit=crop&crop=face" alt="Dr. Martinez" class="message-avatar" crossorigin="anonymous">
                <div class="message-content">
                  <div class="message-sender">Dr. Martinez (HealthTech)</div>
                  <div class="message-preview">Jordan, just called twice about tonight's deadline. Can we push the UI review to tomorrow morning? Patient portal is critical...</div>
                </div>
                <div class="message-time">34 min ago</div>
              </div>
              <div class="message-item unread" onclick="openConversation('techflow')">
                <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face" alt="Mike R." class="message-avatar" crossorigin="anonymous">
                <div class="message-content">
                  <div class="message-sender">Mike R. (TechFlow)</div>
                  <div class="message-preview">Hey, about that payment... we had some cash flow issues this month. Can we work out a payment plan?</div>
                </div>
                <div class="message-time">2 hours ago</div>
              </div>
              <div class="message-item" onclick="openConversation('ecotech')">
                <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face" alt="Sarah K." class="message-avatar" crossorigin="anonymous">
                <div class="message-content">
                  <div class="message-sender">Sarah K. (EcoTech)</div>
                  <div class="message-preview">Love the database design! Quick question - can we add API endpoints for real-time carbon tracking? Happy to discuss budget.</div>
                </div>
                <div class="message-time">4 hours ago</div>
              </div>
            </div>
          </div>
        </div>

        <div class="sidebar">
          <div class="widget">
            <h3>ğŸ“Š Message Stats</h3>
            <div class="earnings-breakdown">
              <div class="breakdown-item">
                <span>Today's Messages</span>
                <span class="amount warning">12</span>
              </div>
              <div class="breakdown-item">
                <span>Unread</span>
                <span class="amount fee">7</span>
              </div>
              <div class="breakdown-item">
                <span>Response Time Avg</span>
                <span class="amount positive">2.3h</span>
              </div>
              <div class="breakdown-item">
                <span>Active Conversations</span>
                <span class="amount positive">5</span>
              </div>
            </div>
          </div>

          <div class="widget">
            <h3>âš¡ Quick Message Actions</h3>
            <div class="survival-grid">
              <button class="survival-action urgent" onclick="quickReplyAll()">
                <div class="survival-icon">ğŸ“§</div>
                <span>Reply to All<br><small>7 unread</small></span>
              </button>
              <button class="survival-action normal" onclick="sendUpdate()">
                <div class="survival-icon">ğŸ“£</div>
                <span>Send Update<br><small>All clients</small></span>
              </button>
            </div>
          </div>

          <div class="widget">
            <h3>ğŸ‘¥ Active Clients</h3>
            <div class="client-list">
              <div class="client-item problematic" onclick="openConversation('techflow')">
                <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=40&h=40&fit=crop&crop=face" alt="Mike R." class="client-avatar" crossorigin="anonymous">
                <div class="client-info">
                  <div class="client-name">Mike R. (TechFlow)</div>
                  <div class="client-mood">ğŸ’¸ Payment discussion needed</div>
                </div>
                <div class="client-health-score red">!</div>
              </div>
              <div class="client-item neutral" onclick="openConversation('healthtech')">
                <img src="https://images.unsplash.com/photo-1612349317150-e413f6a5b16d?w=40&h=40&fit=crop&crop=face" alt="Dr. Martinez" class="client-avatar" crossorigin="anonymous">
                <div class="client-info">
                  <div class="client-name">Dr. Martinez (HealthTech)</div>
                  <div class="client-mood">â° Deadline pressure</div>
                </div>
                <div class="client-health-score yellow">2</div>
              </div>
              <div class="client-item happy" onclick="openConversation('ecotech')">
                <img src="https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=40&h=40&fit=crop&crop=face" alt="Sarah K." class="client-avatar" crossorigin="anonymous">
                <div class="client-info">
                  <div class="client-name">Sarah K. (EcoTech)</div>
                  <div class="client-mood">ğŸŒŸ Scope expansion interest</div>
                </div>
                <div class="client-health-score green">+</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div style="margin-top: 2rem; text-align: center;">
        <p style="color: var(--text-muted); margin-bottom: 1rem;">
          ğŸ’¡ <strong>For Developers:</strong> URL parameters supported:<br>
          <code>?client=techflow</code> <code>?urgent=payment</code> <code>?filter=unread</code>
        </p>
        <button data-action="dashboard" class="btn btn-primary">
          Back to Dashboard
        </button>
      </div>
    </div>
  </section>
</main>

<!-- Mobile Navigation Overlay -->
<div class="mobile-nav-overlay">
  <nav class="mobile-nav" aria-label="Mobile navigation">
    <a href="#" data-action="dashboard" class="mobile-nav-link">Dashboard</a>
    <a href="#" data-action="projects" class="mobile-nav-link">Projects <span class="nav-badge">7</span></a>
    <a href="#" data-action="payments" class="mobile-nav-link">Payments <span class="nav-badge urgent">2</span></a>
    <a href="#" data-action="messages" class="mobile-nav-link active">Messages <span class="nav-badge">12</span></a>
    <div class="mobile-nav-buttons">
      <a href="#" data-action="profile" class="btn btn-secondary">Profile</a>
      <a href="#" data-action="logout" class="btn btn-primary">Logout</a>
    </div>
  </nav>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // Mobile menu functionality
  const mobileMenu = document.getElementById('mobile-menu');
  const mobileOverlay = document.querySelector('.mobile-nav-overlay');

  mobileMenu?.addEventListener('click', () => {
    mobileOverlay.classList.toggle('active');
    const isExpanded = mobileMenu.getAttribute('aria-expanded') === 'true';
    mobileMenu.setAttribute('aria-expanded', !isExpanded);
  });

  mobileOverlay?.addEventListener('click', (e) => {
    if (e.target === mobileOverlay) {
      mobileOverlay.classList.remove('active');
      mobileMenu?.setAttribute('aria-expanded', 'false');
    }
  });

  // Show URL parameters if any
  const urlParams = new URLSearchParams(window.location.search);
  if (urlParams.toString()) {
    showToast(`Messages page loaded with: ${urlParams.toString()}`, 'info');

    // Handle specific client parameter
    const client = urlParams.get('client');
    const urgent = urlParams.get('urgent');

    if (client && urgent === 'payment') {
      setTimeout(() => {
        showToast(`Opening urgent payment discussion with ${client}`, 'warning');
        showUrgentMessages();
      }, 1000);
    }
  }
});

function showUrgentMessages() {
  const urgentSection = document.getElementById('urgent-messages');
  if (urgentSection) {
    urgentSection.scrollIntoView({ behavior: 'smooth' });
    urgentSection.style.border = '2px solid var(--warning)';
    setTimeout(() => {
      urgentSection.style.border = '';
    }, 3000);
  }
}

function replyToClient(clientId) {
  const clientNames = {
    'healthtech': 'Dr. Martinez (HealthTech)',
    'techflow': 'Mike R. (TechFlow)',
    'ecotech': 'Sarah K. (EcoTech)'
  };

  const responses = {
    'healthtech': 'Hi Dr. Martinez! I understand the urgency. Let me send you the current mockups and we can review them tonight. The patient portal is indeed critical.',
    'techflow': 'Hi Mike, I understand cash flow can be challenging. Let\'s set up a payment plan that works for both of us. Can we discuss this on our 6 PM call?',
    'ecotech': 'Hi Sarah! Great to hear you love the database design. Real-time carbon tracking sounds interesting - let\'s schedule a quick call to discuss scope and budget.'
  };

  const clientName = clientNames[clientId] || clientId;
  const response = responses[clientId] || 'Professional response prepared';

  const confirmed = confirm(`Reply to ${clientName}?\n\nSuggested response:\n"${response}"\n\nSend this message?`);

  if (confirmed) {
    showToast(`Message sent to ${clientName} âœ…`, 'success');

    // Update UI to show message sent
    setTimeout(() => {
      const urgentItem = document.querySelector(`[onclick="replyToClient('${clientId}')"]`).closest('.urgent-item');
      if (urgentItem) {
        urgentItem.style.opacity = '0.6';
        urgentItem.innerHTML = urgentItem.innerHTML.replace('btn-urgent', 'btn-urgent disabled');
        urgentItem.querySelector('.btn-urgent').textContent = 'Replied âœ“';
      }
    }, 500);
  }
}

function openConversation(clientId) {
  const clientNames = {
    'healthtech': 'Dr. Martinez (HealthTech)',
    'techflow': 'Mike R. (TechFlow)',
    'ecotech': 'Sarah K. (EcoTech)'
  };

  const clientName = clientNames[clientId] || clientId;
  showToast(`Opening conversation with ${clientName}...`, 'info');

  // This would open the full chat interface
  setTimeout(() => {
    showToast('Full chat interface coming soon! ğŸ’¬', 'warning');
  }, 1000);
}

function quickReplyAll() {
  const confirmed = confirm('Send quick replies to all 7 unread messages?\n\nThis will send appropriate responses based on message context:\nâ€¢ Acknowledgments for updates\nâ€¢ Professional replies for questions\nâ€¢ Schedule requests for complex topics\n\nProceed?');

  if (confirmed) {
    showToast('Preparing replies to all unread messages...', 'info');

    setTimeout(() => {
      showToast('âœ… 7 replies sent successfully', 'success');

      // Update unread count
      document.querySelectorAll('.nav-badge').forEach(badge => {
        if (badge.textContent === '12') {
          badge.textContent = '5';
        }
      });
    }, 2500);
  }
}

function sendUpdate() {
  showToast('Opening client update generator...', 'info');
  setTimeout(() => {
    showToast('Update system coming soon! ğŸ“£', 'warning');
  }, 1000);
}

function showToast(message, type = 'info') {
  const toast = document.createElement('div');
  toast.textContent = message;
  toast.style.cssText = `
    position: fixed; top: 20px; right: 20px; z-index: 10000;
    background: ${type === 'error' ? '#ef4444' : type === 'success' ? '#10b981' : type === 'warning' ? '#f59e0b' : '#6366f1'};
    color: white; padding: 12px 20px; border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15); font-size: 14px;
    transform: translateX(100%); transition: transform 0.3s ease;
  `;

  document.body.appendChild(toast);

  setTimeout(() => toast.style.transform = 'translateX(0)', 100);
  setTimeout(() => {
    toast.style.transform = 'translateX(100%)';
    setTimeout(() => document.body.removeChild(toast), 300);
  }, 4000);
}
</script>

<script src="js/ui.js"></script>
<script src="js/button_logic.js"></script>

<script src="js/api.js"></script>
<script src="js/navigation.js"></script>
</body>
</html>